<%= form_with(model: project) do |form| %>
  <%= render "error_messages", resource: form.object %>

  <div class="form-group">
    <%= form.label :name %>
    <%= form.text_field :name, class: "input input-bordered w-full", value: RandomNameGenerator.generate_name %>
  </div>

  <div class="form-group">
    <%= form.label :cluster_id %>
    <%= form.collection_select :cluster_id, current_user.clusters, :id, :name, {}, { class: "select select-bordered" } %>
  </div>

  <div data-controller="partial-select">
    <div class="form-group">
      <%= form.label :project_type %>
      <%= form.select(
        :project_type,
        Project.project_types.keys.map { |type| [type.titleize, type] },
        {},
        class: "select select-bordered",
        data: {
          "partial-select-target": "select",
          "select-attribute-value": "data-project-type",
          "action": "change->partial-select#toggle",
        }
      ) %>
    </div>
    <div class="text-sm mb-4">
      <p>
        <b>Web service</b>: Useful for publicly accessible services like web applications.
      </p>
      <p>
        <b>Internal service</b>: Useful for services that should only be connected to within the cluster like microservices.
      </p>
      <p>
        <b>Process</b>: Useful for services that should don't need to be connected to like background workers that are continuously running.
      </p>
      <p>
        <b>Cron job</b>: Useful for running tasks at a specific time like backups.
      </p>
      <div class="mt-4 text-warning italic">
        Do not create any databases here, create an <%= link_to "add on", add_ons_path %> and then connect it to your project.
      </div>
    </div>

    <div class="mb-4 hidden" data-partial-select-target="toggleable" data-project-type="cron_job">
      <%= form.label :cron_schedule %>
      <%= form.text_field :cron_schedule, class: "input input-bordered w-full" %>
    </div>
  </div>

  <div class="form-group">
    <%= form.label :repository_url %>
    <%= form.text_field :repository_url, class: "input input-bordered w-full" %>
  </div>

  <div class="form-group">
    <%= form.label :branch %>
    <%= form.text_field :branch, class: "input input-bordered w-full" %>
  </div>

  <div class="form-group">
    <%= form.label :container_registry %>
    <%= form.text_field :container_registry, class: "input input-bordered w-full" %>
  </div>


  <div class="form-group">
    <%= form.label :autodeploy %>
    <%= form.check_box :autodeploy, class: "checkbox" %>
  </div>

  <div class="form-group">
    <%= form.label :dockerfile_path %>
    <%= form.text_field :dockerfile_path, class: "input input-bordered w-full" %>
  </div>

  <div class="form-group">
    <%= form.label :docker_command %>
    <%= form.text_field :docker_command, class: "input input-bordered w-full" %>
  </div>

  <div class="form-group">
    <%= form.label :predeploy_command %>
    <%= form.text_field :predeploy_command, class: "input input-bordered w-full" %>
  </div>

  <div>
    <%= form.button button_text(form.send(:submit_default_value)), class: "btn btn-primary" %>

    <% if form.object.new_record? %>
      <%= link_to t("cancel"), projects_path, class: "btn btn-secondary" %>
    <% else %>
      <%= link_to t("cancel"), project_path(@project), class: "btn btn-secondary" %>
    <% end %>
  </div>
<% end %>
